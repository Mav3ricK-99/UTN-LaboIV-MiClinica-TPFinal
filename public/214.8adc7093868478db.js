"use strict";(self.webpackChunkMiClinica=self.webpackChunkMiClinica||[]).push([[214],{1214:(eo,w,d)=>{d.r(w),d.d(w,{TurnosModule:()=>Xn});var m=d(4755),F=d(9771),e=d(2223),q=d(3119),p=d(3562),U=d(7396),A=d(650),x=d(4004),C=d(4315),h=d(5184);let g=(()=>{class o{constructor(n,t){this.firestore=n,this.usuariosService=t,this.turnosCollection=(0,p.hJ)(this.firestore,"turnos")}nuevoTurno(n){return(0,p.ET)(this.turnosCollection,{especialidad:n.especialidad,especialista_uid:n.especialista.uid,paciente_uid:n.paciente.uid,fecha_turno:n.fecha_turno,detalle:n.detalle,estado:n.estado})}traerTodos(n){let t=(0,p.IO)(this.turnosCollection);return n&&(t=(0,p.IO)(this.turnosCollection,this.filtrar(n))),(0,p.BS)(t,{idField:"uid"}).pipe((0,x.U)(a=>a.map(r=>this.armarTurno(r,!0))))}traerMisTurnos(n){var t=this.usuariosService.usuarioIngresado;let a=t instanceof A.T?"paciente_uid":"especialista_uid",r=(0,p.IO)(this.turnosCollection,(0,p.ar)(a,"==",t?.uid));return n&&(r=(0,p.IO)(this.turnosCollection,(0,U.xD)((0,p.ar)(a,"==",t?.uid),this.filtrar(n)))),(0,p.BS)(r,{idField:"uid"}).pipe((0,x.U)(c=>c.map(u=>{let s=this.armarTurno(u);return t instanceof h.r&&this.usuariosService.traerUsuario(u.paciente_uid).then(f=>{if(f.exists()){let b=this.usuariosService.armarPaciente(f.data());s.paciente=b}}),s})))}actualizarEstadoTurno(n,t,a){const r=(0,p.JU)(this.firestore,"turnos",n.uid);return(0,p.r7)(r,{estado:t,mensaje:a??""})}calificarTurno(n,t){const a=(0,p.JU)(this.firestore,"turnos",n.uid);return(0,p.r7)(a,{calificacion:t})}enviarEncuesta(n,t){const a=(0,p.JU)(this.firestore,"turnos",n.uid);return(0,p.r7)(a,{encuesta:t})}traerTurnosUsuario(n){let t="";n instanceof h.r?t="especialista_uid":n instanceof A.T&&(t="paciente_uid");const a=(0,p.IO)(this.turnosCollection,(0,p.ar)(t,"==",n.uid));return(0,p.BS)(a,{idField:"uid"}).pipe((0,x.U)(r=>r.map(c=>{let u=this.armarTurno(c);return n instanceof h.r?u.especialista=n:n instanceof A.T&&(u.paciente=n),u})))}armarTurno(n,t){{let a=new C.v(n.uid,n.especialidad,n.fecha_turno,n.detalle);return a.estado=n.estado,n.calificacion&&(a.calificacion=n.calificacion),n.encuesta&&(a.encuesta=n.encuesta),n.mensaje&&(a.mensaje=n.mensaje),this.usuariosService.usuarioIngresado instanceof A.T&&(a.paciente=this.usuariosService.usuarioIngresado),t&&this.usuariosService.traerUsuario(n.paciente_uid).then(r=>{let c;r.exists()&&(c=this.usuariosService.armarPaciente(r.data()),a.paciente=c)}),this.usuariosService.traerUsuario(n.especialista_uid).then(r=>{let c;r.exists()&&(c=this.usuariosService.armarEspecialista(r.data()),a.especialista=c)}),a}}filtrar(n){let t=(0,p.ar)("especialidad","==",n.especialidad);return null!=n.especialidad?t=n.paciente?(0,U.xD)((0,p.ar)("especialidad","==",n.especialidad),(0,p.ar)("paciente_uid","==",n.paciente.uid)):n.especialista?(0,U.xD)((0,p.ar)("especialidad","==",n.especialidad),(0,p.ar)("especialista_uid","==",n.especialista.uid)):(0,p.ar)("especialidad","==",n.especialidad):n.paciente?t=(0,p.ar)("paciente_uid","==",n.paciente.uid):n.especialista&&(t=(0,p.ar)("especialista_uid","==",n.especialista.uid)),t}}return o.\u0275fac=function(n){return new(n||o)(e.LFG(p.gg),e.LFG(q.i))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var l=d(5030);const j=["botonCierreModalCancelarTurno"];function O(o,i){if(1&o&&(e.TgZ(0,"h1",17),e._uU(1),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.hij("Cancelacion del turno con ",n.soyPaciente?n.turno.especialista.nombre:n.turno.paciente.nombre,"")}}function L(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion del rechazo es requerido. "),e.qZA())}function R(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion debe contener al menos 6 digitos. "),e.qZA())}function P(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion debe contener como maximo 255 caracteres. "),e.qZA())}function G(o,i){if(1&o&&(e.TgZ(0,"div",18),e.YNc(1,L,2,0,"div",19),e.YNc(2,R,2,0,"div",19),e.YNc(3,P,2,0,"div",19),e.qZA()),2&o){const n=e.oxw();let t,a,r;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioCancelarTurno.get("descripcion"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(a=n.formularioCancelarTurno.get("descripcion"))||null==a.errors?null:a.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==(r=n.formularioCancelarTurno.get("descripcion"))||null==r.errors?null:r.errors.maxlength)}}let S=(()=>{class o{constructor(n,t){this.turnosService=n,this.formBuilder=t,this.formularioCancelarTurno=this.formBuilder.group({descripcion:new l.NI("",[l.kI.required,l.kI.minLength(6),l.kI.maxLength(255)])})}cancelarTurno(){if(!this.formularioCancelarTurno.valid)return;let n=this.formularioCancelarTurno.get("descripcion")?.value;this.turnosService.actualizarEstadoTurno(this.turno,C.C.cancelado,n),this.botonCierreModalCancelarTurno.nativeElement.click()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(g),e.Y36(l.qu))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-cancelar-turno"]],viewQuery:function(n,t){if(1&n&&e.Gf(j,5),2&n){let a;e.iGM(a=e.CRH())&&(t.botonCierreModalCancelarTurno=a.first)}},inputs:{turno:"turno",soyPaciente:"soyPaciente"},decls:21,vars:3,consts:[["id","modalCancelarTurno","tabindex","-1","aria-labelledby","modalCancelarTurnoLabel","aria-hidden","true",1,"modal","fade","col-md-5"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["class","modal-title fs-5","id","modalCancelarTurnoLabel",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["botonCierreModalCancelarTurno",""],[3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"form-row","d-flex","justify-content-around","mb-4"],[1,"form-group","col-md-12"],["for","descripcionCancelar"],["id","descripcionCancelar","placeholder","Cancele el turno porque...","formControlName","descripcion",1,"form-control"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary"],["id","modalCancelarTurnoLabel",1,"modal-title","fs-5"],[1,"alert","alert-danger","mt-3"],[4,"ngIf"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,O,2,1,"h1",4),e._UZ(5,"button",5,6),e.qZA(),e.TgZ(7,"form",7),e.NdJ("ngSubmit",function(){return t.cancelarTurno()}),e.TgZ(8,"div",8)(9,"div",9)(10,"div",10)(11,"label",11),e._uU(12,"Especifique la razon de la cancelacion del turno."),e.qZA(),e.TgZ(13,"textarea",12),e._uU(14," "),e.qZA(),e.YNc(15,G,4,3,"div",13),e.qZA()()(),e.TgZ(16,"div",14)(17,"button",15),e._uU(18,"Descartar cambios"),e.qZA(),e.TgZ(19,"button",16),e._uU(20,"Cancelar turno"),e.qZA()()()()()()),2&n){let a;e.xp6(4),e.Q6J("ngIf",t.turno),e.xp6(3),e.Q6J("formGroup",t.formularioCancelarTurno),e.xp6(8),e.Q6J("ngIf",(null==(a=t.formularioCancelarTurno.get("descripcion"))?null:a.invalid)&&((null==(a=t.formularioCancelarTurno.get("descripcion"))?null:a.dirty)||(null==(a=t.formularioCancelarTurno.get("descripcion"))?null:a.touched)))}},dependencies:[m.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u],styles:[".modal-dialog[_ngcontent-%COMP%]{min-width:35vw!important;min-height:35vh!important}"]}),o})();function $(o,i){1&o&&(e.TgZ(0,"a",13),e._UZ(1,"i",14),e.qZA())}function D(o,i){if(1&o){const n=e.EpF();e.TgZ(0,"tr",9)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA(),e.TgZ(14,"td"),e.YNc(15,$,2,0,"a",10),e.TgZ(16,"ul",11)(17,"li")(18,"a",12),e.NdJ("click",function(){const r=e.CHM(n).$implicit,c=e.oxw(3);return e.KtG(c.seleccionarTurno(r))}),e._uU(19,"Cancelar"),e.qZA()()()()()}if(2&o){const n=i.$implicit;e.xp6(2),e.Oqu(n.especialista.nombre),e.xp6(2),e.Oqu(n.paciente.nombre),e.xp6(2),e.Oqu(n.especialidad),e.xp6(2),e.Oqu(n.detalle),e.xp6(2),e.Oqu(e.xi3(11,7,n.fecha_turno,"dd/M/Y H:mm")),e.xp6(3),e.Oqu(n.estado),e.xp6(2),e.Q6J("ngIf",n.pendiente())}}function H(o,i){if(1&o&&(e.ynx(0),e.YNc(1,D,20,10,"tr",8),e.BQk()),2&o){const n=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",n)}}function B(o,i){1&o&&(e.TgZ(0,"tr")(1,"td",15),e._uU(2,"No se encontraron turnos que mostrar."),e.qZA()())}function W(o,i){if(1&o&&(e.TgZ(0,"tbody"),e.YNc(1,H,2,1,"ng-container",4),e.YNc(2,B,3,0,"ng-template",null,7,e.W1O),e.qZA()),2&o){const n=i.ngIf,t=e.MAs(3);e.xp6(1),e.Q6J("ngIf",n.length>0)("ngIfElse",t)}}function K(o,i){1&o&&(e.TgZ(0,"tbody")(1,"tr")(2,"td",15),e._uU(3,"Cargando..."),e.qZA()()())}let V=(()=>{class o{constructor(n){this.turnosService=n,this.turnos$=this.turnosService.traerTodos()}seleccionarTurno(n){this.turnoSeleccionado=n}ngOnChanges(n){n.filtrosTurnos.firstChange||(this.turnos$=this.turnosService.traerTodos(n.filtrosTurnos.currentValue))}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tabla-turnos-administrador"]],inputs:{filtrosTurnos:["filtros","filtrosTurnos"]},features:[e.TTD],decls:22,vars:6,consts:[[1,"table-responsive"],[1,"table","table-striped"],[1,"table-dark"],["scope","col",1,"text-center"],[4,"ngIf","ngIfElse"],["loader",""],[3,"soyPaciente","turno"],["noHayTurnos",""],["class","text-center",4,"ngFor","ngForOf"],[1,"text-center"],["href","#","data-bs-toggle","dropdown",4,"ngIf"],[1,"dropdown-menu"],["data-bs-toggle","modal","data-bs-target","#modalCancelarTurno",1,"dropdown-item",3,"click"],["href","#","data-bs-toggle","dropdown"],[1,"bi","bi-three-dots-vertical","mx-auto","mb-1"],["colspan","7","align","center"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"table",1)(2,"thead")(3,"tr",2)(4,"th",3),e._uU(5,"A cargo del profesional"),e.qZA(),e.TgZ(6,"th",3),e._uU(7,"Paciente"),e.qZA(),e.TgZ(8,"th",3),e._uU(9,"Especialidad"),e.qZA(),e.TgZ(10,"th",3),e._uU(11,"Detalle"),e.qZA(),e.TgZ(12,"th",3),e._uU(13,"Fecha del turno"),e.qZA(),e.TgZ(14,"th",3),e._uU(15,"Estado"),e.qZA(),e._UZ(16,"th"),e.qZA()(),e.YNc(17,W,4,2,"tbody",4),e.ALo(18,"async"),e.YNc(19,K,4,0,"ng-template",null,5,e.W1O),e.qZA()(),e._UZ(21,"app-modal-cancelar-turno",6)),2&n){const a=e.MAs(20);e.xp6(17),e.Q6J("ngIf",e.lcZ(18,4,t.turnos$))("ngIfElse",a),e.xp6(4),e.Q6J("soyPaciente",!1)("turno",t.turnoSeleccionado)}},dependencies:[m.sg,m.O5,S,m.Ov,m.uU]}),o})();var _=d(6964);const X=["botonCierreModal"];function ee(o,i){1&o&&(e.TgZ(0,"h1",23),e._uU(1,"Complete una breve encuesta para mejorar. "),e._UZ(2,"br"),e._uU(3,"Gracias por tu tiempo!"),e.qZA())}function ne(o,i){if(1&o&&(e.TgZ(0,"h1",23),e._uU(1),e.qZA()),2&o){const n=e.oxw(2);e.xp6(1),e.hij("Aqui la encuesta completada por ",n.turno.paciente.nombre,"")}}function oe(o,i){if(1&o&&e.YNc(0,ne,2,1,"h1",24),2&o){const n=e.oxw();e.Q6J("ngIf",n.turno)}}function te(o,i){if(1&o&&e._UZ(0,"i"),2&o){const n=i.fill;e.Gre("bi-star",100===n?"-fill":"",""),e.ekj("filled",100===n)}}function ae(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El puntaje es requerido "),e.qZA())}function ie(o,i){if(1&o&&(e.TgZ(0,"div",25),e.YNc(1,ae,2,0,"div",26),e.qZA()),2&o){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioEncuestaTurno.get("puntajeInstalaciones"))||null==t.errors?null:t.errors.required)}}function re(o,i){if(1&o&&(e.TgZ(0,"h5",27),e._uU(1),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.Oqu(n.calificacionInstalaciones)}}function le(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion de las instalaciones debe contener al menos 6 digitos. "),e.qZA())}function ce(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion de las instalaciones debe contener como maximo 255 caracteres. "),e.qZA())}function ue(o,i){if(1&o&&(e.TgZ(0,"div",25),e.YNc(1,le,2,0,"div",26),e.YNc(2,ce,2,0,"div",26),e.qZA()),2&o){const n=e.oxw();let t,a;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioEncuestaTurno.get("descripcionInstalaciones"))||null==t.errors?null:t.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==(a=n.formularioEncuestaTurno.get("descripcionInstalaciones"))||null==a.errors?null:a.errors.maxlength)}}function se(o,i){if(1&o&&e._UZ(0,"i"),2&o){const n=i.fill;e.Gre("bi-star",100===n?"-fill":"",""),e.ekj("filled",100===n)}}function de(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El puntaje es requerido "),e.qZA())}function pe(o,i){if(1&o&&(e.TgZ(0,"div",25),e.YNc(1,de,2,0,"div",26),e.qZA()),2&o){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioEncuestaTurno.get("puntajeRecepcion"))||null==t.errors?null:t.errors.required)}}function me(o,i){if(1&o&&(e.TgZ(0,"h5",27),e._uU(1),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.Oqu(n.calificacionRecepcion)}}function fe(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion de el servicio en recepcion debe contener al menos 6 digitos. "),e.qZA())}function _e(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion de el servicio en recepcion debe contener como maximo 255 caracteres. "),e.qZA())}function Te(o,i){if(1&o&&(e.TgZ(0,"div",25),e.YNc(1,fe,2,0,"div",26),e.YNc(2,_e,2,0,"div",26),e.qZA()),2&o){const n=e.oxw();let t,a;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioEncuestaTurno.get("descripcionRecepcion"))||null==t.errors?null:t.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==(a=n.formularioEncuestaTurno.get("descripcionRecepcion"))||null==a.errors?null:a.errors.maxlength)}}function ge(o,i){1&o&&(e.TgZ(0,"button",28),e._uU(1,"Enviar encuesta"),e.qZA())}let Q=(()=>{class o{constructor(n,t,a){this.turnosService=n,this.formBuilder=t,this.formularioEncuestaTurno=this.formBuilder.group({puntajeInstalaciones:new l.NI(null,l.kI.required),descripcionInstalacines:new l.NI("",[l.kI.minLength(6),l.kI.maxLength(255)]),puntajeRecepcion:new l.NI(null,l.kI.required),descripcionRecepcion:new l.NI("",[l.kI.minLength(6),l.kI.maxLength(255)])}),a.max=5}ngOnChanges(){if(this.turno&&this.turno.existeEncuesta()){const n=this.turno.encuesta;this.formularioEncuestaTurno.get("puntajeInstalaciones")?.setValue(n.puntajeInstalaciones),this.formularioEncuestaTurno.get("descripcionInstalacines")?.setValue(n.mensajeInstalaciones),this.formularioEncuestaTurno.get("puntajeRecepcion")?.setValue(n.puntajeRecepcion),this.formularioEncuestaTurno.get("descripcionRecepcion")?.setValue(n.mensajeRecepcion),this.formularioEncuestaTurno.disable()}}cambioRate(n,t){let a="";switch(n){case 1:a="Terrible";break;case 2:a="Muy mala";break;case 3:a="Pudo ser mejor";break;case 4:a="Muy buena";break;case 5:a="Excelente"}switch(t){case"instalaciones":this.calificacionInstalaciones=a;break;case"recepcion":this.calificacionRecepcion=a}}cambiarMensajeCalificacion(n){let t="";switch(this.formularioEncuestaTurno.get(n)?.value){case 1:t="Terrible";break;case 2:t="Muy mala";break;case 3:t="Pudo ser mejor";break;case 4:t="Muy buena";break;case 5:t="Excelente"}switch(n){case"puntajeInstalaciones":this.calificacionInstalaciones=t;break;case"puntajeRecepcion":this.calificacionRecepcion=t}}enviarEncuesta(){if(!this.formularioEncuestaTurno.valid)return;let n={mensajeInstalaciones:this.formularioEncuestaTurno.get("descripcionInstalacines")?.value,puntajeInstalaciones:this.formularioEncuestaTurno.get("puntajeInstalaciones")?.value,mensajeRecepcion:this.formularioEncuestaTurno.get("descripcionRecepcion")?.value,puntajeRecepcion:this.formularioEncuestaTurno.get("puntajeRecepcion")?.value};this.turnosService.enviarEncuesta(this.turno,n),this.botonCierreModal.nativeElement.click()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(g),e.Y36(l.qu),e.Y36(_.M0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-encuesta-turno"]],viewQuery:function(n,t){if(1&n&&e.Gf(X,5),2&n){let a;e.iGM(a=e.CRH())&&(t.botonCierreModal=a.first)}},inputs:{turno:"turno"},features:[e.TTD],decls:42,vars:10,consts:[["id","modalEncuesta","tabindex","-1","aria-labelledby","modalEncuestaLabel","aria-hidden","true",1,"modal","fade","col-md-5"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["class","w-100 modal-title fs-5 text-center","id","modalEncuestaLabel",4,"ngIf","ngIfElse"],["mensajeVerEncuesta",""],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["botonCierreModal",""],[3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"d-flex","flex-column","align-items-around"],[1,"form-group","col-md-12"],[1,"d-flex","flex-column","align-items-center"],["formControlName","puntajeInstalaciones",3,"leave","hover"],["class","alert alert-danger mt-3",4,"ngIf"],["class","h6 p-2",4,"ngIf"],["for","descripcionCalificar"],["id","descripcionCalificar","placeholder","Muy buena iluminacion...","formControlName","descripcionInstalacines",1,"form-control"],["formControlName","puntajeRecepcion",3,"leave","hover"],["id","descripcionCalificar","placeholder","Me atendieron rapido...","formControlName","descripcionRecepcion",1,"form-control"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit","class","btn btn-primary",4,"ngIf"],["id","modalEncuestaLabel",1,"w-100","modal-title","fs-5","text-center"],["class","w-100 modal-title fs-5 text-center","id","modalEncuestaLabel",4,"ngIf"],[1,"alert","alert-danger","mt-3"],[4,"ngIf"],[1,"h6","p-2"],["type","submit",1,"btn","btn-primary"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,ee,4,0,"h1",4),e.YNc(5,oe,1,1,"ng-template",null,5,e.W1O),e._UZ(7,"button",6,7),e.qZA(),e.TgZ(9,"form",8),e.NdJ("ngSubmit",function(){return t.enviarEncuesta()}),e.TgZ(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"label"),e._uU(15,"Calificacion de nuestras instalaciones"),e.qZA(),e.TgZ(16,"ngb-rating",13),e.NdJ("leave",function(){return t.cambiarMensajeCalificacion("puntajeInstalaciones")})("hover",function(r){return t.cambioRate(r,"instalaciones")}),e.YNc(17,te,1,5,"ng-template"),e.qZA(),e.YNc(18,ie,2,1,"div",14),e.YNc(19,re,2,1,"h5",15),e.qZA(),e.TgZ(20,"label",16),e._uU(21,"Que le parecio nuestras instalaciones."),e.qZA(),e.TgZ(22,"textarea",17),e._uU(23," "),e.qZA(),e.YNc(24,ue,3,2,"div",14),e.qZA(),e.TgZ(25,"div",11)(26,"div",12)(27,"label"),e._uU(28,"Calificacion de servicio de asistencia brindado"),e.qZA(),e.TgZ(29,"ngb-rating",18),e.NdJ("leave",function(){return t.cambiarMensajeCalificacion("puntajeRecepcion")})("hover",function(r){return t.cambioRate(r,"recepcion")}),e.YNc(30,se,1,5,"ng-template"),e.qZA(),e.YNc(31,pe,2,1,"div",14),e.YNc(32,me,2,1,"h5",15),e.qZA(),e.TgZ(33,"label",16),e._uU(34,"Como fue la atencion que le brindaron en la recepcion."),e.qZA(),e.TgZ(35,"textarea",19),e._uU(36," "),e.qZA(),e.YNc(37,Te,3,2,"div",14),e.qZA()()(),e.TgZ(38,"div",20)(39,"button",21),e._uU(40,"Descartar cambios"),e.qZA(),e.YNc(41,ge,2,0,"button",22),e.qZA()()()()()),2&n){const a=e.MAs(6);let r,c,u,s;e.xp6(4),e.Q6J("ngIf",!(null!=t.turno&&t.turno.existeEncuesta()))("ngIfElse",a),e.xp6(5),e.Q6J("formGroup",t.formularioEncuestaTurno),e.xp6(9),e.Q6J("ngIf",(null==(r=t.formularioEncuestaTurno.get("puntajeInstalaciones"))?null:r.invalid)&&((null==(r=t.formularioEncuestaTurno.get("puntajeInstalaciones"))?null:r.dirty)||(null==(r=t.formularioEncuestaTurno.get("puntajeInstalaciones"))?null:r.touched))),e.xp6(1),e.Q6J("ngIf",!(null!=t.turno&&t.turno.existeEncuesta())),e.xp6(5),e.Q6J("ngIf",(null==(c=t.formularioEncuestaTurno.get("descripcionInstalaciones"))?null:c.invalid)&&((null==(c=t.formularioEncuestaTurno.get("descripcionInstalaciones"))?null:c.dirty)||(null==(c=t.formularioEncuestaTurno.get("descripcionInstalaciones"))?null:c.touched))),e.xp6(7),e.Q6J("ngIf",(null==(u=t.formularioEncuestaTurno.get("puntajeRecepcion"))?null:u.invalid)&&((null==(u=t.formularioEncuestaTurno.get("puntajeRecepcion"))?null:u.dirty)||(null==(u=t.formularioEncuestaTurno.get("puntajeRecepcion"))?null:u.touched))),e.xp6(1),e.Q6J("ngIf",!(null!=t.turno&&t.turno.existeEncuesta())),e.xp6(5),e.Q6J("ngIf",(null==(s=t.formularioEncuestaTurno.get("descripcionRecepcion"))?null:s.invalid)&&((null==(s=t.formularioEncuestaTurno.get("descripcionRecepcion"))?null:s.dirty)||(null==(s=t.formularioEncuestaTurno.get("descripcionRecepcion"))?null:s.touched))),e.xp6(4),e.Q6J("ngIf",!(null!=t.turno&&t.turno.existeEncuesta()))}},dependencies:[m.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,_.OC],styles:[".modal-dialog[_ngcontent-%COMP%]{min-width:35vw!important;min-height:35vh!important}i[_ngcontent-%COMP%]{font-size:1.5rem;padding-right:.1rem;color:#edcb0a}.filled[_ngcontent-%COMP%]{color:gold}"]}),o})();const be=["botonCierreModal"];function he(o,i){if(1&o&&(e.TgZ(0,"h1",17),e._uU(1),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.hij("Rechazo del turno con ",n.turno.paciente.nombre,"")}}function ve(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion del rechazo es requerido. "),e.qZA())}function Ze(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion debe contener al menos 6 digitos. "),e.qZA())}function Ce(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion debe contener como maximo 255 caracteres. "),e.qZA())}function xe(o,i){if(1&o&&(e.TgZ(0,"div",18),e.YNc(1,ve,2,0,"div",19),e.YNc(2,Ze,2,0,"div",19),e.YNc(3,Ce,2,0,"div",19),e.qZA()),2&o){const n=e.oxw();let t,a,r;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioRechazarTurno.get("descripcion"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(a=n.formularioRechazarTurno.get("descripcion"))||null==a.errors?null:a.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==(r=n.formularioRechazarTurno.get("descripcion"))||null==r.errors?null:r.errors.maxlength)}}let qe=(()=>{class o{constructor(n,t){this.turnosService=n,this.formBuilder=t,this.formularioRechazarTurno=this.formBuilder.group({descripcion:new l.NI("",[l.kI.required,l.kI.minLength(6),l.kI.maxLength(255)])})}rechazarTurno(){if(!this.formularioRechazarTurno.valid)return;let n=this.formularioRechazarTurno.get("descripcion")?.value;this.turnosService.actualizarEstadoTurno(this.turno,C.C.rechazado,n),this.botonCierreModal.nativeElement.click()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(g),e.Y36(l.qu))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-rechazar-turno"]],viewQuery:function(n,t){if(1&n&&e.Gf(be,5),2&n){let a;e.iGM(a=e.CRH())&&(t.botonCierreModal=a.first)}},inputs:{turno:"turno"},decls:21,vars:3,consts:[["id","modalRechazarTurno","tabindex","-1","aria-labelledby","modalRechazarTurnoLabel","aria-hidden","true",1,"modal","fade","col-md-5"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["class","modal-title fs-5","id","modalRechazarTurnoLabel",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["botonCierreModal",""],[3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"form-row","d-flex","justify-content-around","mb-4"],[1,"form-group","col-md-12"],["for","descripcionRechazar"],["id","descripcionRechazar","placeholder","EL paciente no especifico...","formControlName","descripcion",1,"form-control"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary"],["id","modalRechazarTurnoLabel",1,"modal-title","fs-5"],[1,"alert","alert-danger","mt-3"],[4,"ngIf"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,he,2,1,"h1",4),e._UZ(5,"button",5,6),e.qZA(),e.TgZ(7,"form",7),e.NdJ("ngSubmit",function(){return t.rechazarTurno()}),e.TgZ(8,"div",8)(9,"div",9)(10,"div",10)(11,"label",11),e._uU(12,"Especifique la razon del rechazo del turno."),e.qZA(),e.TgZ(13,"textarea",12),e._uU(14," "),e.qZA(),e.YNc(15,xe,4,3,"div",13),e.qZA()()(),e.TgZ(16,"div",14)(17,"button",15),e._uU(18,"Descartar cambios"),e.qZA(),e.TgZ(19,"button",16),e._uU(20,"Rechazar turno"),e.qZA()()()()()()),2&n){let a;e.xp6(4),e.Q6J("ngIf",t.turno),e.xp6(3),e.Q6J("formGroup",t.formularioRechazarTurno),e.xp6(8),e.Q6J("ngIf",(null==(a=t.formularioRechazarTurno.get("descripcion"))?null:a.invalid)&&((null==(a=t.formularioRechazarTurno.get("descripcion"))?null:a.dirty)||(null==(a=t.formularioRechazarTurno.get("descripcion"))?null:a.touched)))}},dependencies:[m.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u],styles:[".modal-dialog[_ngcontent-%COMP%]{min-width:35vw!important;min-height:35vh!important}"]}),o})();const Ae=["botonCierreModal"];function ye(o,i){if(1&o&&(e.TgZ(0,"h1",17),e._uU(1),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.hij("Finaliazacion del turno con ",n.turno.paciente.nombre,"")}}function Ie(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion del diagnostico es requerido. "),e.qZA())}function Ee(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion debe contener al menos 6 digitos. "),e.qZA())}function Me(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion debe contener como maximo 255 caracteres. "),e.qZA())}function Ue(o,i){if(1&o&&(e.TgZ(0,"div",18),e.YNc(1,Ie,2,0,"div",19),e.YNc(2,Ee,2,0,"div",19),e.YNc(3,Me,2,0,"div",19),e.qZA()),2&o){const n=e.oxw();let t,a,r;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioFinalizarTurno.get("descripcion"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(a=n.formularioFinalizarTurno.get("descripcion"))||null==a.errors?null:a.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==(r=n.formularioFinalizarTurno.get("descripcion"))||null==r.errors?null:r.errors.maxlength)}}let Se=(()=>{class o{constructor(n,t){this.turnosService=n,this.formBuilder=t,this.formularioFinalizarTurno=this.formBuilder.group({descripcion:new l.NI("",[l.kI.required,l.kI.minLength(6),l.kI.maxLength(255)])})}finalizarTurno(){if(!this.formularioFinalizarTurno.valid)return;let n=this.formularioFinalizarTurno.get("descripcion")?.value;this.turnosService.actualizarEstadoTurno(this.turno,C.C.finalizado,n),this.botonCierreModal.nativeElement.click()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(g),e.Y36(l.qu))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-finalizar-turno"]],viewQuery:function(n,t){if(1&n&&e.Gf(Ae,5),2&n){let a;e.iGM(a=e.CRH())&&(t.botonCierreModal=a.first)}},inputs:{turno:"turno"},decls:21,vars:3,consts:[["id","modalFinalizarTurno","tabindex","-1","aria-labelledby","modalFinalizarTurnoLabel","aria-hidden","true",1,"modal","fade","col-md-5"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["class","modal-title fs-5","id","modalFinalizarTurnoLabel",4,"ngIf"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["botonCierreModal",""],[3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"form-row","d-flex","justify-content-around","mb-4"],[1,"form-group","col-md-12"],["for","descripcionRechazar"],["id","descripcionRechazar","placeholder","Sufria de una otitis incurable...","formControlName","descripcion",1,"form-control"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary"],["id","modalFinalizarTurnoLabel",1,"modal-title","fs-5"],[1,"alert","alert-danger","mt-3"],[4,"ngIf"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,ye,2,1,"h1",4),e._UZ(5,"button",5,6),e.qZA(),e.TgZ(7,"form",7),e.NdJ("ngSubmit",function(){return t.finalizarTurno()}),e.TgZ(8,"div",8)(9,"div",9)(10,"div",10)(11,"label",11),e._uU(12,"Escriba el diagnostico realizado."),e.qZA(),e.TgZ(13,"textarea",12),e._uU(14," "),e.qZA(),e.YNc(15,Ue,4,3,"div",13),e.qZA()()(),e.TgZ(16,"div",14)(17,"button",15),e._uU(18,"Descartar cambios"),e.qZA(),e.TgZ(19,"button",16),e._uU(20,"Finalizar turno"),e.qZA()()()()()()),2&n){let a;e.xp6(4),e.Q6J("ngIf",t.turno),e.xp6(3),e.Q6J("formGroup",t.formularioFinalizarTurno),e.xp6(8),e.Q6J("ngIf",(null==(a=t.formularioFinalizarTurno.get("descripcion"))?null:a.invalid)&&((null==(a=t.formularioFinalizarTurno.get("descripcion"))?null:a.dirty)||(null==(a=t.formularioFinalizarTurno.get("descripcion"))?null:a.touched)))}},dependencies:[m.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u]}),o})();function Ne(o,i){if(1&o){const n=e.EpF();e.TgZ(0,"a",19),e.NdJ("click",function(){e.CHM(n);const a=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.seleccionarTurno(a))}),e._uU(1,"Cancelar"),e.qZA()}}function Je(o,i){if(1&o){const n=e.EpF();e.TgZ(0,"a",20),e.NdJ("click",function(){e.CHM(n);const a=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.seleccionarTurno(a))}),e._uU(1,"Rechazar"),e.qZA()}}function we(o,i){if(1&o){const n=e.EpF();e.TgZ(0,"a",21),e.NdJ("click",function(){e.CHM(n);const a=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.aceptarTurno(a))}),e._uU(1,"Aceptar"),e.qZA()}}function Fe(o,i){if(1&o){const n=e.EpF();e.TgZ(0,"a",22),e.NdJ("click",function(){e.CHM(n);const a=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.seleccionarTurno(a))}),e._uU(1,"Finalizar"),e.qZA()}}function Qe(o,i){if(1&o){const n=e.EpF();e.TgZ(0,"a",23),e.NdJ("click",function(){e.CHM(n);const a=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.seleccionarTurno(a))}),e._uU(1,"Ver rese\xf1a"),e.qZA()}}function Ye(o,i){if(1&o&&(e.TgZ(0,"tr",10)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td")(13,"a",11),e._UZ(14,"i",12),e.qZA(),e.TgZ(15,"ul",13)(16,"li"),e.YNc(17,Ne,2,0,"a",14),e.qZA(),e.TgZ(18,"li"),e.YNc(19,Je,2,0,"a",15),e.qZA(),e.TgZ(20,"li"),e.YNc(21,we,2,0,"a",16),e.qZA(),e.TgZ(22,"li"),e.YNc(23,Fe,2,0,"a",17),e.qZA(),e.TgZ(24,"li"),e.YNc(25,Qe,2,0,"a",18),e.qZA()()()()),2&o){const n=i.$implicit;e.xp6(2),e.Oqu(n.paciente.nombre),e.xp6(2),e.Oqu(n.especialidad),e.xp6(2),e.Oqu(n.detalle),e.xp6(2),e.Oqu(e.xi3(9,10,n.fecha_turno,"dd/M/Y H:mm")),e.xp6(3),e.Oqu(n.estado),e.xp6(6),e.Q6J("ngIf",n.pendiente()),e.xp6(2),e.Q6J("ngIf",n.pendiente()),e.xp6(2),e.Q6J("ngIf",n.pendiente()),e.xp6(2),e.Q6J("ngIf",n.activo()),e.xp6(2),e.Q6J("ngIf",n.existeEncuesta())}}function ke(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Ye,26,13,"tr",9),e.BQk()),2&o){const n=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",n)}}function ze(o,i){1&o&&(e.TgZ(0,"tr")(1,"td",24),e._uU(2,"No se encontraron turnos que mostrar."),e.qZA()())}function je(o,i){if(1&o&&(e.TgZ(0,"tbody"),e.YNc(1,ke,2,1,"ng-container",4),e.YNc(2,ze,3,0,"ng-template",null,8,e.W1O),e.qZA()),2&o){const n=i.ngIf,t=e.MAs(3);e.xp6(1),e.Q6J("ngIf",n.length>0)("ngIfElse",t)}}function Oe(o,i){1&o&&(e.TgZ(0,"tbody")(1,"tr")(2,"td",24),e._uU(3,"Cargando..."),e.qZA()()())}let Le=(()=>{class o{constructor(n){this.turnosService=n,this.turnos$=this.turnosService.traerMisTurnos()}seleccionarTurno(n){this.turnoSeleccionado=n}aceptarTurno(n){this.turnosService.actualizarEstadoTurno(n,C.C.aprobado)}ngOnChanges(n){n.filtrosTurnos.firstChange||(this.turnos$=this.turnosService.traerMisTurnos(n.filtrosTurnos.currentValue))}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tabla-turnos-especialista"]],inputs:{filtrosTurnos:["filtros","filtrosTurnos"]},features:[e.TTD],decls:23,vars:9,consts:[[1,"table-responsive"],[1,"table","table-striped"],[1,"table-dark"],["scope","col",1,"text-center"],[4,"ngIf","ngIfElse"],["loader",""],[3,"soyPaciente","turno"],[3,"turno"],["noHayTurnos",""],["class","text-center",4,"ngFor","ngForOf"],[1,"text-center"],["href","#","data-bs-toggle","dropdown"],[1,"bi","bi-three-dots-vertical","mx-auto","mb-1"],[1,"dropdown-menu"],["class","dropdown-item","data-bs-toggle","modal","data-bs-toggle","modal","data-bs-target","#modalCancelarTurno",3,"click",4,"ngIf"],["class","dropdown-item","data-bs-toggle","modal","data-bs-toggle","modal","data-bs-target","#modalRechazarTurno",3,"click",4,"ngIf"],["class","dropdown-item",3,"click",4,"ngIf"],["class","dropdown-item","data-bs-toggle","modal","data-bs-toggle","modal","data-bs-target","#modalFinalizarTurno",3,"click",4,"ngIf"],["class","dropdown-item","data-bs-toggle","modal","data-bs-target","#modalEncuesta",3,"click",4,"ngIf"],["data-bs-toggle","modal","data-bs-toggle","modal","data-bs-target","#modalCancelarTurno",1,"dropdown-item",3,"click"],["data-bs-toggle","modal","data-bs-toggle","modal","data-bs-target","#modalRechazarTurno",1,"dropdown-item",3,"click"],[1,"dropdown-item",3,"click"],["data-bs-toggle","modal","data-bs-toggle","modal","data-bs-target","#modalFinalizarTurno",1,"dropdown-item",3,"click"],["data-bs-toggle","modal","data-bs-target","#modalEncuesta",1,"dropdown-item",3,"click"],["colspan","6","align","center"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"table",1)(2,"thead")(3,"tr",2)(4,"th",3),e._uU(5,"Paciente"),e.qZA(),e.TgZ(6,"th",3),e._uU(7,"Especialidad"),e.qZA(),e.TgZ(8,"th",3),e._uU(9,"Detalle"),e.qZA(),e.TgZ(10,"th",3),e._uU(11,"Fecha del turno"),e.qZA(),e.TgZ(12,"th",3),e._uU(13,"Estado"),e.qZA(),e._UZ(14,"th"),e.qZA()(),e.YNc(15,je,4,2,"tbody",4),e.ALo(16,"async"),e.YNc(17,Oe,4,0,"ng-template",null,5,e.W1O),e.qZA()(),e._UZ(19,"app-modal-cancelar-turno",6)(20,"app-modal-rechazar-turno",7)(21,"app-modal-finalizar-turno",7)(22,"app-modal-encuesta-turno",7)),2&n){const a=e.MAs(18);e.xp6(15),e.Q6J("ngIf",e.lcZ(16,7,t.turnos$))("ngIfElse",a),e.xp6(4),e.Q6J("soyPaciente",!1)("turno",t.turnoSeleccionado),e.xp6(1),e.Q6J("turno",t.turnoSeleccionado),e.xp6(1),e.Q6J("turno",t.turnoSeleccionado),e.xp6(1),e.Q6J("turno",t.turnoSeleccionado)}},dependencies:[m.sg,m.O5,S,Q,qe,Se,m.Ov,m.uU]}),o})();const Re=["botonCierreModal"];function Pe(o,i){if(1&o&&(e.TgZ(0,"label",20),e._uU(1),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.hij("Comentenos como fue la atencion con ",n.turno.especialista.nombre,".")}}function Ge(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion es requerido. "),e.qZA())}function $e(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion debe contener al menos 6 digitos. "),e.qZA())}function De(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo descripcion debe contener como maximo 255 caracteres. "),e.qZA())}function He(o,i){if(1&o&&(e.TgZ(0,"div",21),e.YNc(1,Ge,2,0,"div",22),e.YNc(2,$e,2,0,"div",22),e.YNc(3,De,2,0,"div",22),e.qZA()),2&o){const n=e.oxw();let t,a,r;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioCalificarTurno.get("descripcion"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(a=n.formularioCalificarTurno.get("descripcion"))||null==a.errors?null:a.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==(r=n.formularioCalificarTurno.get("descripcion"))||null==r.errors?null:r.errors.maxlength)}}function Be(o,i){if(1&o&&e._UZ(0,"i"),2&o){const n=i.fill;e.Gre("bi-star",100===n?"-fill":"",""),e.ekj("filled",100===n)}}function We(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El puntaje es requerido "),e.qZA())}function Ke(o,i){if(1&o&&(e.TgZ(0,"div",21),e.YNc(1,We,2,0,"div",22),e.qZA()),2&o){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioCalificarTurno.get("puntaje"))||null==t.errors?null:t.errors.required)}}let Ve=(()=>{class o{constructor(n,t,a){this.turnosService=n,this.formBuilder=t,this.formularioCalificarTurno=this.formBuilder.group({descripcion:new l.NI("",[l.kI.required,l.kI.minLength(6),l.kI.maxLength(255)]),puntaje:new l.NI(null,l.kI.required)}),a.max=5}cambioRate(n){switch(n){case 1:this.calificacion="Terrible";break;case 2:this.calificacion="Muy mala";break;case 3:this.calificacion="Pudo ser mejor";break;case 4:this.calificacion="Muy buena";break;case 5:this.calificacion="Excelente"}}cambiarMensajeCalificacion(){switch(this.formularioCalificarTurno.get("puntaje")?.value){case 1:this.calificacion="Terrible";break;case 2:this.calificacion="Muy mala";break;case 3:this.calificacion="Pudo ser mejor";break;case 4:this.calificacion="Muy buena";break;case 5:this.calificacion="Excelente"}}calificarTurno(){if(!this.formularioCalificarTurno.valid)return;let n={mensaje:this.formularioCalificarTurno.get("descripcion")?.value,puntaje:this.formularioCalificarTurno.get("puntaje")?.value};this.turnosService.calificarTurno(this.turno,n),this.botonCierreModal.nativeElement.click()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(g),e.Y36(l.qu),e.Y36(_.M0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-calificar-atencion"]],viewQuery:function(n,t){if(1&n&&e.Gf(Re,5),2&n){let a;e.iGM(a=e.CRH())&&(t.botonCierreModal=a.first)}},inputs:{turno:"turno"},decls:29,vars:5,consts:[["id","modalCalificarTurno","tabindex","-1","aria-labelledby","modalCalificarTurnoLabel","aria-hidden","true",1,"modal","fade","col-md-5"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","modalCalificarTurnoLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["botonCierreModal",""],[3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"form-row","d-flex","justify-content-around"],[1,"form-group","col-md-12"],["for","descripcionCalificar",4,"ngIf"],["id","descripcionCalificar","placeholder","El doctor fue muy amable...","formControlName","descripcion",1,"form-control"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"m-2","d-flex","flex-column","align-items-center"],["formControlName","puntaje",3,"leave","hover"],[1,"h6","p-2"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary"],["for","descripcionCalificar"],[1,"alert","alert-danger","mt-3"],[4,"ngIf"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),e._uU(5,"Calificar turno"),e.qZA(),e._UZ(6,"button",5,6),e.qZA(),e.TgZ(8,"form",7),e.NdJ("ngSubmit",function(){return t.calificarTurno()}),e.TgZ(9,"div",8)(10,"div",9)(11,"div",10),e.YNc(12,Pe,2,1,"label",11),e.TgZ(13,"textarea",12),e._uU(14," "),e.qZA(),e.YNc(15,He,4,3,"div",13),e.TgZ(16,"div",14)(17,"label"),e._uU(18,"Calificacion"),e.qZA(),e.TgZ(19,"ngb-rating",15),e.NdJ("leave",function(){return t.cambiarMensajeCalificacion()})("hover",function(r){return t.cambioRate(r)}),e.YNc(20,Be,1,5,"ng-template"),e.qZA(),e.YNc(21,Ke,2,1,"div",13),e.TgZ(22,"h5",16),e._uU(23),e.qZA()()()()(),e.TgZ(24,"div",17)(25,"button",18),e._uU(26,"Descartar cambios"),e.qZA(),e.TgZ(27,"button",19),e._uU(28,"Calificar turno"),e.qZA()()()()()()),2&n){let a,r;e.xp6(8),e.Q6J("formGroup",t.formularioCalificarTurno),e.xp6(4),e.Q6J("ngIf",t.turno),e.xp6(3),e.Q6J("ngIf",(null==(a=t.formularioCalificarTurno.get("descripcion"))?null:a.invalid)&&((null==(a=t.formularioCalificarTurno.get("descripcion"))?null:a.dirty)||(null==(a=t.formularioCalificarTurno.get("descripcion"))?null:a.touched))),e.xp6(6),e.Q6J("ngIf",(null==(r=t.formularioCalificarTurno.get("puntaje"))?null:r.invalid)&&((null==(r=t.formularioCalificarTurno.get("puntaje"))?null:r.dirty)||(null==(r=t.formularioCalificarTurno.get("puntaje"))?null:r.touched))),e.xp6(2),e.Oqu(t.calificacion)}},dependencies:[m.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,_.OC],styles:[".modal-dialog[_ngcontent-%COMP%]{min-width:35vw!important;min-height:35vh!important}i[_ngcontent-%COMP%]{font-size:1.5rem;padding-right:.1rem;color:#edcb0a}.filled[_ngcontent-%COMP%]{color:gold}"]}),o})();var y=d(7579),I=d(9646),Y=d(6451),Xe=d(4986),en=d(4482),nn=d(5403);function v(o,i=Xe.z){return(0,en.e)((n,t)=>{let a=null,r=null,c=null;const u=()=>{if(a){a.unsubscribe(),a=null;const f=r;r=null,t.next(f)}};function s(){const f=c+o,b=i.now();if(b<f)return a=this.schedule(void 0,f-b),void t.add(a);u()}n.subscribe((0,nn.x)(t,f=>{r=f,c=i.now(),a||(a=i.schedule(s,o),t.add(a))},()=>{u(),t.complete()},void 0,()=>{r=a=null}))})}var Z=d(1884),T=d(8505),E=d(3900),M=d(262),k=d(9300);const on=["selectEsp"];function tn(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," La especilidad es requerida "),e.qZA())}function an(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo especialidad debe contener como minimo 6 caracteres. "),e.qZA())}function rn(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El campo especialidad debe contener como maximo 255 caracteres. "),e.qZA())}function ln(o,i){if(1&o&&(e.TgZ(0,"div",11),e.YNc(1,tn,2,0,"div",12),e.YNc(2,an,2,0,"div",12),e.YNc(3,rn,2,0,"div",12),e.qZA()),2&o){const n=e.oxw();let t,a,r;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioFiltros.get("especialidad"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(a=n.formularioFiltros.get("especialidad"))||null==a.errors?null:a.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==(r=n.formularioFiltros.get("especialidad"))||null==r.errors?null:r.errors.maxlength)}}function cn(o,i){if(1&o&&e._UZ(0,"ngb-highlight",13),2&o){const t=i.term;e.Q6J("result",i.result.nombre)("term",t)}}function un(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," Un medico es requerido para el turno. "),e.qZA())}function sn(o,i){if(1&o&&(e.TgZ(0,"div",11),e.YNc(1,un,2,0,"div",12),e.qZA()),2&o){const n=e.oxw(2);let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioFiltros.get("especialista"))||null==t.errors?null:t.errors.required)}}function dn(o,i){if(1&o&&(e.TgZ(0,"div",14)(1,"label",15),e._uU(2,"Especialistas:"),e.qZA(),e._UZ(3,"input",16),e.YNc(4,sn,2,1,"div",6),e.qZA()),2&o){const n=e.oxw(),t=e.MAs(11);let a;e.xp6(3),e.Q6J("resultTemplate",t)("inputFormatter",n.formatter)("ngbTypeahead",n.buscarEspecialista)("editable",!1),e.xp6(1),e.Q6J("ngIf",(null==(a=n.formularioFiltros.get("especialista"))?null:a.invalid)&&((null==(a=n.formularioFiltros.get("especialista"))?null:a.dirty)||(null==(a=n.formularioFiltros.get("especialista"))?null:a.touched)))}}function pn(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El paciente para este turno es requerido."),e.qZA())}function mn(o,i){if(1&o&&(e.TgZ(0,"div",11),e.YNc(1,pn,2,0,"div",12),e.qZA()),2&o){const n=e.oxw(2);let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioFiltros.get("paciente"))||null==t.errors?null:t.errors.required)}}function fn(o,i){if(1&o&&(e.TgZ(0,"div",14)(1,"label",17),e._uU(2,"Pacientes:"),e.qZA(),e._UZ(3,"input",18),e.YNc(4,mn,2,1,"div",6),e.qZA()),2&o){const n=e.oxw(),t=e.MAs(11);let a;e.xp6(3),e.Q6J("resultTemplate",t)("inputFormatter",n.formatter)("ngbTypeahead",n.buscarPaciente)("editable",!1),e.xp6(1),e.Q6J("ngIf",(null==(a=n.formularioFiltros.get("paciente"))?null:a.invalid)&&((null==(a=n.formularioFiltros.get("paciente"))?null:a.dirty)||(null==(a=n.formularioFiltros.get("paciente"))?null:a.touched)))}}let z=(()=>{class o{constructor(n,t){this.usuariosService=t,this.filtro=new e.vpe,this.focus$=new y.x,this.click$=new y.x,this.buscando=!1,this.busquedaFallida=!1,this.buscarEspecialista=a=>a.pipe(v(300),(0,Z.x)(),(0,T.b)(()=>this.buscando=!0),(0,E.w)(r=>{let c,u=this.formularioFiltros.get("especialidad")?.value;return c=u?this.usuariosService.buscarEspecialistaPorEspecialidad(u,r):this.usuariosService.buscarUsuario(r,"especialista"),c.pipe((0,T.b)(()=>this.busquedaFallida=!1),(0,M.K)(()=>(this.busquedaFallida=!0,(0,I.of)([]))))}),(0,T.b)(()=>this.buscando=!1)),this.buscarPaciente=a=>a.pipe(v(300),(0,Z.x)(),(0,T.b)(()=>this.buscando=!0),(0,E.w)(r=>this.usuariosService.buscarUsuario(r,"paciente").pipe((0,T.b)(()=>this.busquedaFallida=!1),(0,M.K)(()=>(this.busquedaFallida=!0,(0,I.of)([]))))),(0,T.b)(()=>this.buscando=!1)),this.buscarEspecialidad=a=>{const r=a.pipe(v(200),(0,Z.x)()),c=this.click$.pipe((0,k.h)(()=>!this.selectEsp.isPopupOpen()));return(0,Y.T)(r,this.focus$,c).pipe((0,x.U)(s=>(""===s?Object.values(h.w):Object.values(h.w).filter(f=>f.toLowerCase().indexOf(s.toLowerCase())>-1)).slice(0,10)))},this.formatter=a=>a.nombre,this.formularioFiltros=n.group({especialidad:new l.NI(null,[l.kI.minLength(6),l.kI.maxLength(255)])}),this.formularioFiltros.valueChanges.pipe(v(200),(0,Z.x)()).subscribe(a=>this.actualizarFiltros(a))}ngOnInit(){this.formularioFiltros.addControl("paciente"==this.filtrarPor?"paciente":"especialista",new l.NI(null))}actualizarFiltros(n){if(!this.formularioFiltros.valid||null==n.especialidad&&null==n.paciente&&null==n.especialista)return;let t={especialidad:n.especialidad};"paciente"==this.filtrarPor?t.paciente=n.paciente:t.especialista=n.especialista,this.filtro.emit(t)}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(l.qu),e.Y36(q.i))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-filtros-turnos"]],viewQuery:function(n,t){if(1&n&&e.Gf(on,7),2&n){let a;e.iGM(a=e.CRH())&&(t.selectEsp=a.first)}},inputs:{filtrarPor:"filtrarPor"},outputs:{filtro:"filtro"},decls:17,vars:5,consts:[[1,"d-flex","flex-column","col-md-12"],[1,"d-flex","mb-3",3,"formGroup"],[1,"form-group","col-md-3","me-4"],["for","especialidad",1,"col-xs-3","col-sm-auto","col-form-label"],["id","especialidad","type","text","formControlName","especialidad",1,"form-control",3,"ngbTypeahead","focus","click"],["selectEsp","ngbTypeahead"],["class","alert alert-danger mt-3",4,"ngIf"],["rt",""],["class","form-group col-md-3",4,"ngIf","ngIfElse"],["filtroPaciente",""],[1,"text-muted"],[1,"alert","alert-danger","mt-3"],[4,"ngIf"],[3,"result","term"],[1,"form-group","col-md-3"],["for","especialistas",1,"col-xs-3","col-sm-auto","col-form-label"],["id","especialistas","type","text","formControlName","especialista",1,"form-control",3,"resultTemplate","inputFormatter","ngbTypeahead","editable"],["for","pacientes",1,"col-xs-3","col-sm-auto","col-form-label"],["id","pacientes","type","text","formControlName","paciente",1,"form-control",3,"resultTemplate","inputFormatter","ngbTypeahead","editable"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"h3"),e._uU(2,"Filtros tabla"),e.qZA(),e.TgZ(3,"form",1)(4,"div",2)(5,"label",3),e._uU(6,"Buscar por especialidad:"),e.qZA(),e.TgZ(7,"input",4,5),e.NdJ("focus",function(r){return t.focus$.next(r.target.value)})("click",function(r){return t.click$.next(r.target.value)}),e.qZA(),e.YNc(9,ln,4,3,"div",6),e.qZA(),e.YNc(10,cn,1,2,"ng-template",null,7,e.W1O),e.YNc(12,dn,5,5,"div",8),e.YNc(13,fn,5,5,"ng-template",null,9,e.W1O),e.qZA(),e.TgZ(15,"small",10),e._uU(16,"*Escribe el nombre de la especialidad buscada o del paciente/especialista para filtrar la tabla"),e.qZA()()),2&n){const a=e.MAs(14);let r;e.xp6(3),e.Q6J("formGroup",t.formularioFiltros),e.xp6(4),e.Q6J("ngbTypeahead",t.buscarEspecialidad),e.xp6(2),e.Q6J("ngIf",(null==(r=t.formularioFiltros.get("especialidad"))?null:r.invalid)&&((null==(r=t.formularioFiltros.get("especialidad"))?null:r.dirty)||(null==(r=t.formularioFiltros.get("especialidad"))?null:r.touched))),e.xp6(3),e.Q6J("ngIf","especialista"==t.filtrarPor)("ngIfElse",a)}},dependencies:[m.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,_._h,_.dR]}),o})();function _n(o,i){if(1&o){const n=e.EpF();e.TgZ(0,"a",18),e.NdJ("click",function(){e.CHM(n);const a=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.seleccionarTurno(a))}),e._uU(1,"Cancelar"),e.qZA()}}function Tn(o,i){1&o&&(e.TgZ(0,"a",19),e._uU(1,"Ver rese\xf1a"),e.qZA())}function gn(o,i){if(1&o){const n=e.EpF();e.TgZ(0,"a",20),e.NdJ("click",function(){e.CHM(n);const a=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.seleccionarTurno(a))}),e._uU(1,"Completar encuesta"),e.qZA()}}function bn(o,i){if(1&o){const n=e.EpF();e.TgZ(0,"a",21),e.NdJ("click",function(){e.CHM(n);const a=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.seleccionarTurno(a))}),e._uU(1,"Calificar atencion"),e.qZA()}}function hn(o,i){if(1&o&&(e.TgZ(0,"tr",10)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td")(13,"a",11),e._UZ(14,"i",12),e.qZA(),e.TgZ(15,"ul",13)(16,"li"),e.YNc(17,_n,2,0,"a",14),e.qZA(),e.TgZ(18,"li"),e.YNc(19,Tn,2,0,"a",15),e.qZA(),e.TgZ(20,"li"),e.YNc(21,gn,2,0,"a",16),e.qZA(),e.TgZ(22,"li"),e.YNc(23,bn,2,0,"a",17),e.qZA()()()()),2&o){const n=i.$implicit;e.xp6(2),e.Oqu(n.especialista.nombre),e.xp6(2),e.Oqu(n.especialidad),e.xp6(2),e.Oqu(n.detalle),e.xp6(2),e.Oqu(e.xi3(9,9,n.fecha_turno,"dd/M/Y H:mm")),e.xp6(3),e.Oqu(n.estado),e.xp6(6),e.Q6J("ngIf",!n.finalizado()&&n.activo()),e.xp6(2),e.Q6J("ngIf",n.existeEncuesta()),e.xp6(2),e.Q6J("ngIf",!n.existeEncuesta()&&n.finalizado()),e.xp6(2),e.Q6J("ngIf",!n.existeCalificacionTurno()&&n.finalizado())}}function vn(o,i){if(1&o&&(e.ynx(0),e.YNc(1,hn,24,12,"tr",9),e.BQk()),2&o){const n=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",n)}}function Zn(o,i){1&o&&(e.TgZ(0,"tr")(1,"td",22),e._uU(2,"No se encontraron turnos que mostrar."),e.qZA()())}function Cn(o,i){if(1&o&&(e.TgZ(0,"tbody"),e.YNc(1,vn,2,1,"ng-container",4),e.YNc(2,Zn,3,0,"ng-template",null,8,e.W1O),e.qZA()),2&o){const n=i.ngIf,t=e.MAs(3);e.xp6(1),e.Q6J("ngIf",n.length>0)("ngIfElse",t)}}function xn(o,i){1&o&&(e.TgZ(0,"tbody")(1,"tr")(2,"td",22),e._uU(3,"Cargando..."),e.qZA()()())}let qn=(()=>{class o{constructor(n){this.turnosService=n,this.turnos$=this.turnosService.traerMisTurnos()}seleccionarTurno(n){this.turnoSeleccionado=n}ngOnChanges(n){n.filtrosTurnos.firstChange||(this.turnos$=this.turnosService.traerMisTurnos(n.filtrosTurnos.currentValue))}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tabla-turnos-paciente"]],inputs:{filtrosTurnos:["filtros","filtrosTurnos"]},features:[e.TTD],decls:23,vars:8,consts:[[1,"table-responsive"],[1,"table","table-striped"],[1,"table-dark"],["scope","col",1,"text-center"],[4,"ngIf","ngIfElse"],["loader",""],[3,"soyPaciente","turno"],[3,"turno"],["noHayTurnos",""],["class","text-center",4,"ngFor","ngForOf"],[1,"text-center"],["href","#","data-bs-toggle","dropdown"],[1,"bi","bi-three-dots-vertical","mx-auto","mb-1"],[1,"dropdown-menu"],["class","dropdown-item","data-bs-toggle","modal","data-bs-target","#modalCancelarTurno",3,"click",4,"ngIf"],["class","dropdown-item","data-bs-toggle","modal","data-bs-target","#modalEncuesta",4,"ngIf"],["class","dropdown-item","data-bs-toggle","modal","data-bs-target","#modalEncuesta",3,"click",4,"ngIf"],["class","dropdown-item","data-bs-toggle","modal","data-bs-target","#modalCalificarTurno",3,"click",4,"ngIf"],["data-bs-toggle","modal","data-bs-target","#modalCancelarTurno",1,"dropdown-item",3,"click"],["data-bs-toggle","modal","data-bs-target","#modalEncuesta",1,"dropdown-item"],["data-bs-toggle","modal","data-bs-target","#modalEncuesta",1,"dropdown-item",3,"click"],["data-bs-toggle","modal","data-bs-target","#modalCalificarTurno",1,"dropdown-item",3,"click"],["colspan","6","align","center"]],template:function(n,t){if(1&n&&(e._UZ(0,"app-filtros-turnos"),e.TgZ(1,"div",0)(2,"table",1)(3,"thead")(4,"tr",2)(5,"th",3),e._uU(6,"A cargo del profesional"),e.qZA(),e.TgZ(7,"th",3),e._uU(8,"Especialidad"),e.qZA(),e.TgZ(9,"th",3),e._uU(10,"Detalle"),e.qZA(),e.TgZ(11,"th",3),e._uU(12,"Fecha del turno"),e.qZA(),e.TgZ(13,"th",3),e._uU(14,"Estado"),e.qZA(),e._UZ(15,"th"),e.qZA()(),e.YNc(16,Cn,4,2,"tbody",4),e.ALo(17,"async"),e.YNc(18,xn,4,0,"ng-template",null,5,e.W1O),e.qZA()(),e._UZ(20,"app-modal-cancelar-turno",6)(21,"app-modal-calificar-atencion",7)(22,"app-modal-encuesta-turno",7)),2&n){const a=e.MAs(19);e.xp6(16),e.Q6J("ngIf",e.lcZ(17,6,t.turnos$))("ngIfElse",a),e.xp6(4),e.Q6J("soyPaciente",!0)("turno",t.turnoSeleccionado),e.xp6(1),e.Q6J("turno",t.turnoSeleccionado),e.xp6(1),e.Q6J("turno",t.turnoSeleccionado)}},dependencies:[m.sg,m.O5,S,Ve,Q,z,m.Ov,m.uU]}),o})();const N={es:{weekdays:["Lu","Ma","Mi","Ju","Vi","Sa","Do"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],weekLabel:"sem"}};let An=(()=>{class o extends _.wf{constructor(){super()}getWeekdayLabel(n){return N.es.weekdays[n-1]}getWeekLabel(){return N.es.weekLabel}getMonthShortName(n){return N.es.months[n-1]}getMonthFullName(n){return this.getMonthShortName(n)}getDayAriaLabel(n){return`${n.day}-${n.month}-${n.year}`}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})();var yn=d(5226),In=d.n(yn);const En=["botonCierreModal"],Mn=["selectEsp"];function Un(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El paciente para este turno es requerido."),e.qZA())}function Sn(o,i){if(1&o&&(e.TgZ(0,"div",32),e.YNc(1,Un,2,0,"div",33),e.qZA()),2&o){const n=e.oxw(2);let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioSolicitarTurno.get("paciente"))||null==t.errors?null:t.errors.required)}}function Nn(o,i){if(1&o&&(e.TgZ(0,"div",13)(1,"label",30),e._uU(2,"Pacientes:"),e.qZA(),e._UZ(3,"input",31),e.YNc(4,Sn,2,1,"div",17),e.qZA()),2&o){const n=e.oxw(),t=e.MAs(30);let a;e.xp6(3),e.Q6J("resultTemplate",t)("inputFormatter",n.formatter)("ngbTypeahead",n.buscarPaciente)("editable",!1),e.xp6(1),e.Q6J("ngIf",(null==(a=n.formularioSolicitarTurno.get("paciente"))?null:a.invalid)&&((null==(a=n.formularioSolicitarTurno.get("paciente"))?null:a.dirty)||(null==(a=n.formularioSolicitarTurno.get("paciente"))?null:a.touched)))}}function Jn(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," La especilidad es requerida."),e.qZA())}function wn(o,i){if(1&o&&(e.TgZ(0,"div",32),e.YNc(1,Jn,2,0,"div",33),e.qZA()),2&o){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioSolicitarTurno.get("especialidad"))||null==t.errors?null:t.errors.required)}}function Fn(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," Un medico es requerido para el turno. "),e.qZA())}function Qn(o,i){if(1&o&&(e.TgZ(0,"div",32),e.YNc(1,Fn,2,0,"div",33),e.qZA()),2&o){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioSolicitarTurno.get("especialista"))||null==t.errors?null:t.errors.required)}}function Yn(o,i){if(1&o&&e._UZ(0,"ngb-highlight",34),2&o){const t=i.term;e.Q6J("result",i.result.nombre)("term",t)}}function kn(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El horario para el turno es requerido."),e.qZA())}function zn(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," Por favor, elija un turno entre las 8:00AM y 14:00PM"),e.qZA())}function jn(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," Por favor, elija un turno entre las 8:00AM y 14:00PM"),e.qZA())}function On(o,i){if(1&o&&(e.TgZ(0,"div",32),e.YNc(1,kn,2,0,"div",33),e.YNc(2,zn,2,0,"div",33),e.YNc(3,jn,2,0,"div",33),e.qZA()),2&o){const n=e.oxw();let t,a,r;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioSolicitarTurno.get("horarioTurno"))||null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==(a=n.formularioSolicitarTurno.get("horarioTurno"))||null==a.errors?null:a.errors.tooLate),e.xp6(1),e.Q6J("ngIf",null==(r=n.formularioSolicitarTurno.get("horarioTurno"))||null==r.errors?null:r.errors.tooEarly)}}function Ln(o,i){1&o&&(e.TgZ(0,"div",32),e._uU(1," La fecha solicitada no se encuentra disponible para este Especialista. "),e.qZA())}function Rn(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," El detalle para el turno no debe sobrepasar los 255 caracteres. "),e.qZA())}function Pn(o,i){if(1&o&&(e.TgZ(0,"div",32),e.YNc(1,Rn,2,0,"div",33),e.qZA()),2&o){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.formularioSolicitarTurno.get("detalle"))||null==t.errors?null:t.errors.maxlength)}}let Gn=(()=>{class o{constructor(n,t,a,r){this.usuariosService=t,this.turnosService=a,this.formBuilder=r,this.focus$=new y.x,this.click$=new y.x,this.buscando=!1,this.busquedaFallida=!1,this.mesesDatepicker=2,this.showWeekNumbers=!1,this.minutosTurno=30,this.buscarEspecialidad=c=>{const u=c.pipe(v(200),(0,Z.x)()),s=this.click$.pipe((0,k.h)(()=>!this.selectEsp.isPopupOpen()));return(0,Y.T)(u,this.focus$,s).pipe((0,x.U)(b=>(""===b?Object.values(h.w):Object.values(h.w).filter(J=>J.toLowerCase().indexOf(b.toLowerCase())>-1)).slice(0,10)))},this.formatter=c=>c.nombre,this.buscarEspecialista=c=>c.pipe(v(300),(0,Z.x)(),(0,T.b)(()=>this.buscando=!0),(0,E.w)(u=>{let s,f=this.formularioSolicitarTurno.get("especialidad")?.value;return s=f?this.usuariosService.buscarEspecialistaPorEspecialidad(f,u):this.usuariosService.buscarUsuario(u,"especialista"),s.pipe((0,T.b)(()=>this.busquedaFallida=!1),(0,M.K)(()=>(this.busquedaFallida=!0,(0,I.of)([]))))}),(0,T.b)(()=>this.buscando=!1)),this.buscarPaciente=c=>c.pipe(v(300),(0,Z.x)(),(0,T.b)(()=>this.buscando=!0),(0,E.w)(u=>this.usuariosService.buscarUsuario(u,"paciente").pipe((0,T.b)(()=>this.busquedaFallida=!1),(0,M.K)(()=>(this.busquedaFallida=!0,(0,I.of)([]))))),(0,T.b)(()=>this.buscando=!1)),this.fechaHoyNgb=n.getToday(),this.fechaMaxNgb=n.getNext(this.fechaHoyNgb,"d",15),this.formularioSolicitarTurno=this.formBuilder.group({especialidad:new l.NI(null,[l.kI.required,l.kI.minLength(6),l.kI.maxLength(255)]),especialista:new l.NI(null,[l.kI.required]),fechaTurno:new l.NI(null,[l.kI.required]),horarioTurno:new l.NI(null,[l.kI.required,this.validarHorarioTurno]),detalle:new l.NI("",[l.kI.maxLength(255)])},{validators:this.validarFechaTurno()}),this.formularioSolicitarTurno.get("especialista")?.valueChanges.subscribe(c=>this.cambioEspecialista(c)),t.usuarioIngresado?.isAdmin()&&this.formularioSolicitarTurno.addControl("paciente",new l.NI(null,[l.kI.required]))}cambioEspecialista(n){if(n){this.formularioSolicitarTurno.get("especialidad")?.setValue(n.especialidad);var a=this.formularioSolicitarTurno.get("fechaTurno"),r=this.formularioSolicitarTurno.get("horarioTurno");a?.disable(),r?.disable(),this.turnosService.traerTurnosUsuario(n).forEach(c=>{c.forEach(u=>{n.agregarTurno(u)})}),setTimeout(()=>{a?.enable(),r?.enable();let c=n.disponibilidadProxima();if(null!=c){let u={year:c.getFullYear(),month:c.getMonth()+1,day:c.getDate()},s={hour:c.getHours(),minute:c.getMinutes(),second:0};a?.setValue(u),r?.setValue(s)}},1e3)}}validarFechaTurno(){return n=>{let t=n.get("fechaTurno"),a=n.get("horarioTurno"),r=n.get("especialista");if(t?.value&&a?.value&&r?.value){let c=t.value,u=a.value,s=new Date(c.year,c.month-1,c.day,u.hour,u.minute,0);if(!r.value?.disponibleEnFecha(s))return{noDisponible:!0}}return null}}validarHorarioTurno(n){let t=n?.value;return t?t.hour<8?{tooEarly:!0}:t.hour>14?{tooLate:!0}:null:null}solicitarTurno(){if(!this.formularioSolicitarTurno.valid)return;let n=this.usuariosService.usuarioIngresado,t=this.formularioSolicitarTurno.get("especialidad")?.value,a=this.formularioSolicitarTurno.get("especialista")?.value,r=this.formularioSolicitarTurno.get("fechaTurno")?.value,c=this.formularioSolicitarTurno.get("horarioTurno")?.value,u=this.formularioSolicitarTurno.get("detalle")?.value,s=n;n?.isAdmin()&&(s=this.formularioSolicitarTurno.get("paciente")?.value);let f=new Date(r.year,r.month-1,r.day,c.hour,c.minute,0),b=new C.v("0",t,f,u,a,s);this.turnosService.nuevoTurno(b).then(J=>{this.mostrarModal("Turno agregado con Exito","success",`Ahora solo falta que el especialista ${a.nombre} confirme la cita!.`),this.botonCierreModal.nativeElement.click()}).catch(J=>{this.mostrarModal("Hubo un problema al subir la cita","error","Por favor, vuelva a intearlo nuevamente en algunos minutos.")})}mostrarModal(n,t,a){"success"!=t&&"error"!=t||In().fire({title:n,icon:t,text:a,confirmButtonText:"OK!"}).then(()=>{this.formularioSolicitarTurno.reset()})}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(_.vL),e.Y36(q.i),e.Y36(g),e.Y36(l.qu))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-solicitar-turno"]],viewQuery:function(n,t){if(1&n&&(e.Gf(En,5),e.Gf(Mn,7)),2&n){let a;e.iGM(a=e.CRH())&&(t.botonCierreModal=a.first),e.iGM(a=e.CRH())&&(t.selectEsp=a.first)}},features:[e._Bn([{provide:_.wf,useClass:An}])],decls:48,vars:20,consts:[[1,"d-flex","align-items-center","flex-column"],["data-bs-toggle","modal","data-bs-target","#modalSolicitarTurno",1,"btn","btn-primary"],["id","modalSolicitarTurno","tabindex","-1","aria-labelledby","modalSolicitarTurnoLabel","aria-hidden","true",1,"modal","fade","col-md-5"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","modalSolicitarTurnoLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["botonCierreModal",""],[1,"modal-body"],[3,"formGroup","ngSubmit"],[1,"d-flex","flex-column","justify-content-around"],["class","form-group col-md-12 mb-3",4,"ngIf"],[1,"form-group","col-md-12","mb-3"],["for","especialidad"],["id","especialidad","type","text","formControlName","especialidad",1,"form-control",3,"ngbTypeahead","focus","click"],["selectEsp","ngbTypeahead"],["class","alert alert-danger mt-3",4,"ngIf"],["for","especialistas",1,"col-xs-3","col-sm-auto","col-form-label"],["id","especialistas","type","text","formControlName","especialista",1,"form-control",3,"resultTemplate","inputFormatter","ngbTypeahead","editable"],["formControlName","fechaTurno",3,"displayMonths","navigation","maxDate","minDate","showWeekNumbers","outsideDays"],[1,"form-group","col-md-12","mb-2"],["rt",""],[1,"m-2","d-flex","flex-column","align-items-center"],["formControlName","horarioTurno","required","",3,"minuteStep"],["for","detalleTurno",1,"col-xs-3","col-sm-auto","col-form-label"],["id","detalleTurno","formControlName","detalle","noresize","","placeholder","Detalle del nuevo turno...",1,"form-control"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary",3,"disabled"],["for","pacientes",1,"col-xs-3","col-sm-auto","col-form-label"],["id","pacientes","type","text","formControlName","paciente",1,"form-control",3,"resultTemplate","inputFormatter","ngbTypeahead","editable"],[1,"alert","alert-danger","mt-3"],[4,"ngIf"],[3,"result","term"]],template:function(n,t){if(1&n&&(e.TgZ(0,"article",0)(1,"button",1),e._uU(2,"Solicitar Turno"),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h1",6),e._uU(8,"Nuevo turno"),e.qZA(),e._UZ(9,"button",7,8),e.qZA(),e.TgZ(11,"div",9)(12,"form",10),e.NdJ("ngSubmit",function(){return t.solicitarTurno()}),e.TgZ(13,"div",11),e.YNc(14,Nn,5,5,"div",12),e.TgZ(15,"div",13)(16,"label",14),e._uU(17,"Elegi una de nuestras especialidades"),e.qZA(),e.TgZ(18,"input",15,16),e.NdJ("focus",function(r){return t.focus$.next(r.target.value)})("click",function(r){return t.click$.next(r.target.value)}),e.qZA(),e.YNc(20,wn,2,1,"div",17),e.qZA(),e.TgZ(21,"div",13)(22,"label",18),e._uU(23,"Especialistas:"),e.qZA(),e._UZ(24,"input",19),e.YNc(25,Qn,2,1,"div",17),e.qZA(),e.TgZ(26,"div",13),e._UZ(27,"ngb-datepicker",20),e.qZA(),e.TgZ(28,"div",21),e.YNc(29,Yn,1,2,"ng-template",null,22,e.W1O),e.TgZ(31,"div",23)(32,"label"),e._uU(33,"Horario del turno"),e.qZA(),e._UZ(34,"ngb-timepicker",24),e.YNc(35,On,4,3,"div",17),e.YNc(36,Ln,2,0,"div",17),e.qZA()(),e.TgZ(37,"div",23)(38,"div",13)(39,"label",25),e._uU(40,"Detalle del turno (opcional)"),e.qZA(),e._UZ(41,"textarea",26),e.YNc(42,Pn,2,1,"div",17),e.qZA()()(),e.TgZ(43,"div",27)(44,"button",28),e._uU(45,"Cancelar"),e.qZA(),e.TgZ(46,"button",29),e._uU(47,"Confirmar nuevo Turno"),e.qZA()()()()()()()),2&n){const a=e.MAs(30);let r,c,u,s;e.xp6(12),e.Q6J("formGroup",t.formularioSolicitarTurno),e.xp6(2),e.Q6J("ngIf",null==t.usuariosService.usuarioIngresado?null:t.usuariosService.usuarioIngresado.isAdmin()),e.xp6(4),e.Q6J("ngbTypeahead",t.buscarEspecialidad),e.xp6(2),e.Q6J("ngIf",(null==(r=t.formularioSolicitarTurno.get("especialidad"))?null:r.invalid)&&((null==(r=t.formularioSolicitarTurno.get("especialidad"))?null:r.dirty)||(null==(r=t.formularioSolicitarTurno.get("especialidad"))?null:r.touched))),e.xp6(4),e.Q6J("resultTemplate",a)("inputFormatter",t.formatter)("ngbTypeahead",t.buscarEspecialista)("editable",!1),e.xp6(1),e.Q6J("ngIf",(null==(c=t.formularioSolicitarTurno.get("especialista"))?null:c.invalid)&&((null==(c=t.formularioSolicitarTurno.get("especialista"))?null:c.dirty)||(null==(c=t.formularioSolicitarTurno.get("especialista"))?null:c.touched))),e.xp6(2),e.Q6J("displayMonths",t.mesesDatepicker)("navigation","none")("maxDate",t.fechaMaxNgb)("minDate",t.fechaHoyNgb)("showWeekNumbers",!1)("outsideDays","visible"),e.xp6(7),e.Q6J("minuteStep",t.minutosTurno),e.xp6(1),e.Q6J("ngIf",(null==(u=t.formularioSolicitarTurno.get("horarioTurno"))?null:u.invalid)&&((null==(u=t.formularioSolicitarTurno.get("horarioTurno"))?null:u.dirty)||(null==(u=t.formularioSolicitarTurno.get("horarioTurno"))?null:u.touched))),e.xp6(1),e.Q6J("ngIf",(null==t.formularioSolicitarTurno.errors?null:t.formularioSolicitarTurno.errors.noDisponible)&&(t.formularioSolicitarTurno.touched||t.formularioSolicitarTurno.dirty)),e.xp6(6),e.Q6J("ngIf",(null==(s=t.formularioSolicitarTurno.get("detalle"))?null:s.invalid)&&((null==(s=t.formularioSolicitarTurno.get("detalle"))?null:s.dirty)||(null==(s=t.formularioSolicitarTurno.get("detalle"))?null:s.touched))),e.xp6(4),e.Q6J("disabled",!t.formularioSolicitarTurno.valid)}},dependencies:[m.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,_._h,_.dR,_.Pm,_.VL],styles:[".modal-dialog[_ngcontent-%COMP%]{min-width:35vw!important;min-height:35vh!important}textarea[_ngcontent-%COMP%]{resize:none}"]}),o})();function $n(o,i){if(1&o){const n=e.EpF();e.ynx(0),e.TgZ(1,"app-filtros-turnos",6),e.NdJ("filtro",function(a){e.CHM(n);const r=e.oxw();return e.KtG(r.filtrar(a))}),e.qZA(),e.TgZ(2,"h3",7),e._uU(3,"Mis turnos"),e.qZA(),e._UZ(4,"app-tabla-turnos-paciente",8),e.BQk()}if(2&o){const n=e.oxw();e.xp6(4),e.Q6J("filtros",n.filtroTurnos)}}function Dn(o,i){if(1&o){const n=e.EpF();e.ynx(0),e.TgZ(1,"app-filtros-turnos",9),e.NdJ("filtro",function(a){e.CHM(n);const r=e.oxw();return e.KtG(r.filtrar(a))}),e.qZA(),e.TgZ(2,"h3",7),e._uU(3,"Mis turnos asignados"),e.qZA(),e._UZ(4,"app-tabla-turnos-especialista",8),e.BQk()}if(2&o){const n=e.oxw();e.xp6(4),e.Q6J("filtros",n.filtroTurnos)}}function Hn(o,i){if(1&o){const n=e.EpF();e.ynx(0),e.TgZ(1,"app-filtros-turnos",6),e.NdJ("filtro",function(a){e.CHM(n);const r=e.oxw();return e.KtG(r.filtrar(a))}),e.qZA(),e.TgZ(2,"h3",7),e._uU(3,"Todos los turnos"),e.qZA(),e._UZ(4,"app-tabla-turnos-administrador",8),e.BQk()}if(2&o){const n=e.oxw();e.xp6(4),e.Q6J("filtros",n.filtroTurnos)}}function Bn(o,i){1&o&&e._UZ(0,"app-solicitar-turno")}const Wn=[{path:"",component:(()=>{class o{constructor(n){this.usuariosService=n}filtrar(n){this.filtroTurnos=n}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(q.i))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-listado-turnos"]],decls:9,vars:5,consts:[[1,"container-fluid"],[1,"p-2","mb-2","bg-light-dark","rounded-3"],[1,"container-fluid","py-5"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngIf"],["filtrarPor","especialista",3,"filtro"],[1,"text-center","p-2"],[3,"filtros"],["filtrarPor","paciente",3,"filtro"]],template:function(n,t){1&n&&(e.TgZ(0,"section",0)(1,"article")(2,"div",1)(3,"div",2)(4,"container-element",3),e.YNc(5,$n,5,1,"ng-container",4),e.YNc(6,Dn,5,1,"ng-container",4),e.YNc(7,Hn,5,1,"ng-container",4),e.qZA()()()(),e.YNc(8,Bn,1,0,"app-solicitar-turno",5),e.qZA()),2&n&&(e.xp6(4),e.Q6J("ngSwitch",null==t.usuariosService.usuarioIngresado?null:t.usuariosService.usuarioIngresado.tipoUsuario),e.xp6(1),e.Q6J("ngSwitchCase","paciente"),e.xp6(1),e.Q6J("ngSwitchCase","especialista"),e.xp6(1),e.Q6J("ngSwitchCase","admin"),e.xp6(1),e.Q6J("ngIf",null==t.usuariosService.usuarioIngresado?null:t.usuariosService.usuarioIngresado.puedeCrearTurnos()))},dependencies:[m.O5,m.RF,m.n9,V,Le,qn,Gn,z]}),o})()}];let Kn=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[F.Bz.forChild(Wn),F.Bz]}),o})();var Vn=d(2158);let Xn=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[m.ez,Kn,Vn.U,_.mO,_.ZS,_.UL,_.M]}),o})()}}]);